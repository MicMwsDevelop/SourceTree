PC安心サポート管理製品仕様

2018/11/28 Ver1.0.0.0：新規作成（勝呂）

プログラム情報
プログラム名：PC安心サポート管理
実行ファイル名：PcSupportManager.exe
アプリケーション形態：Windows Form アプリケーション（C#）
.NET Frameworkバージョン：.NET Framework 4

起動モード
０：メイン画面起動（引数なし）
１：製品サポート情報ソフト保守更新
２：PC安心サポート開始メール送信
３：PC安心サポート契約更新案内/契約更新メール送信


製品サポート情報ソフト保守更新
処理概要
PC安心サポート管理情報から製品サポート情報ソフト保守の追加および更新を行う

処理内容
１．開始ログ出力
２．最新の受注情報の読込み
３．PC安心サポート管理情報から登録条件を満たしている場合、製品サポート情報ソフト保守に追加および更新
４．終了ログ出力

登録条件
PC安心サポート管理情報の商品ID、契約開始日、契約終了日、契約年数、料金、受注承認日が登録済みであること

実行日
毎月当月初日

更新対象フィールド
fhsS契約書回収年月 ← 受注日
fhsS契約年数 ← 契約年数
fhsSメンテ料金 ← 料金
fhsSメンテ契約開始 ← 契約開始日
fhsSメンテ契約終了 ← 契約終了日
fhsSメンテ契約備考1 ← 備考

PC安心サポート開始メール送信
処理概要
PC安心サポート管理情報から開始メール送信条件を満たしている場合、開始メールを送信してPC安心サポート管理情報を更新する

処理内容
１．開始ログ出力
２．ユーザーに開始メールの送信
３．PC安心サポート管理情報に開始メール送信情報の格納
４．PC安心サポート管理情報の更新
５．営業管理部に開始メール送信対象ユーザーリストの送信
６．各拠点毎に該当ユーザーの開始メール送信対象ユーザーリストの送信
       ※拠店で開始メール送信対象ユーザーがいない場合には、送信しない
７．PC安心サポート送信メール情報の登録
８．終了ログ出力

開始メール送信条件
１．PC安心サポート管理情報の商品ID、契約開始日、契約終了日、契約年数、料金、受注承認日、メールアドレスが登録済み
２．無効フラグがOFF
３．開始メール送信日付がNULL
４．利用期限日がNULL
５．契約開始日が当月末まで

実行日
環境設定の開始メール送信実行日以降で休日でない日

PC安心サポート契約更新案内/契約更新メール送信
処理概要
１．PC安心サポート管理情報から契約更新案内メール送信条件を満たしている場合、契約更新案内メールを送信してPC安心サポート管理情報を更新する
２．PC安心サポート管理情報から契約更新メール送信条件を満たしている場合、契約更新メールを送信してPC安心サポート管理情報を更新する

処理内容
１．開始ログ出力
２．ユーザーに契約更新案内メールの送信
３．PC安心サポート管理情報に契約更新案内メール送信情報の格納
４．PC安心サポート管理情報の契約更新メール送信情報をクリア
５．PC安心サポート管理情報の更新
６．営業管理部に契約更新案内メール送信対象ユーザーリストの送信
７．各拠点毎に該当ユーザーの契約更新案内メール送信対象ユーザーリストの送信
       ※拠店で契約更新案内メール送信対象ユーザーがいない場合には、送信しない
８．PC安心サポート送信メール情報の登録
９．ユーザーに契約更新メールの送信
１０．PC安心サポート管理情報に契約更新メール送信情報の格納
１１．PC安心サポート管理情報の契約更新案内メール送信情報をクリア
１２．PC安心サポート管理情報の更新
１３．営業管理部に契約更新メール送信対象ユーザーリストの送信
１４．各拠点毎に該当ユーザーの契約更新メール送信対象ユーザーリストの送信
       ※拠店で契約更新メール送信対象ユーザーがいない場合には、送信しない
１５．PC安心サポート送信メール情報の登録
１６．終了ログ出力

環境設定
ファイル名：PcSupportManagerSettings.xml
設定内容
開始メール送信実行日：開始メールを送信する日付を設定
開始メール送信前回実行日：前回の開始メール送信実行日
契約更新案内/契約更新メール送信実行日：契約更新案内/契約更新メールを送信する日付を設定
契約更新案内/契約更新メール送信前回実行日：前回の契約更新案内/契約更新メール送信実行日
祝日：祝日の設定
ハッピーマンデー：ハッピーマンデーの設定
臨時休日：会社の臨時休業日の設定
休日：会社の休日の曜日の設定
配置先：カレントフォルダ

ログファイル出力
内容：バッチ処理の製品サポート情報ソフト保守更新、PC安心サポート開始メール送信、PC安心サポート契約更新案内/契約更新メール送信の実行内容のログを出力する
ファイル名：PCSupportManager-YYYYMMDDHHmm.log
出力先：カレントフォルダ

PC安心サポートメールテンプレートファイル
開始メール
ファイル名：StartMailTemplate.txt
メール内容

契約更新案内メール
ファイル名：GuideMailTemplate.txt
メール内容

契約更新メールメール
ファイル名：UpdateMailTemplate.txt
メール内容

配置先：カレントフォルダ

補足
テーブル情報
PC安心サポート管理情報：[Charlie].[dbo].[T_PC_SUPPORT_CONTORL]
製品サポート情報ソフト保守：[JunpDB].[dbo].[tMik保守契約]
PC安心サポート送信メール情報：[Charlie].[dbo].[T_PC_SUPPORT_MAIL]

以上。
